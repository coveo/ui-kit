name: "Create deployment package"
description: "Create a deployment package for Headless and Atomic"
runs:
  using: composite
  steps:
    - id: parse-version
      uses: ./.github/actions/parse-version
    - id: get-pipeline-token
      uses: ./.github/actions/get-pipeline-token
    - name: Create & deploy package
      shell: bash
      run: |
        deployment-package package create --with-deploy \
          --resolve HEADLESS_MINOR_VERSION=${{steps.parse-version.outputs.headless-minor}} \
          --resolve HEADLESS_MAJOR_VERSION=${{steps.parse-version.outputs.headless-major}} \
          --resolve ATOMIC_MINOR_VERSION=${{steps.parse-version.outputs.atomic-minor}} \
          --resolve ATOMIC_MAJOR_VERSION=${{steps.parse-version.outputs.atomic-major}}
      env:
        PIPELINE_API_TOKEN: ${{ steps.get-pipeline-token.outputs.token }}