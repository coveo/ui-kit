# UI-Kit Knowledge Graph Schema

This document defines the **actual implemented schema** for the ui-kit knowledge graph in Memgraph.

> **Note**: This schema was generated by querying the live knowledge graph. Last updated: January 19, 2026

## Node Types

All nodes have an `id` property (integer) for internal identification.

### Package
- **Properties**: `id`, `name`, `path`, `version`, `description`
- **Labels**: `Package`
- **Example**: 
  ```json
  {
    "id": 1,
    "name": "@coveo/atomic",
    "path": "packages/atomic",
    "version": "3.45.0",
    "description": "A web-component library..."
  }
  ```

### File
- **Properties**: `id`, `path`, `name`, `extension`, `size`, `type` (source|test|config|story)
- **Labels**: `File` (base), plus one or more: `SourceFile`, `ConfigFile`, `StoryFile`
- **Example**:
  ```json
  {
    "id": 19,
    "path": "packages/atomic/src/...",
    "name": "atomic-search-box.ts",
    "extension": ".ts",
    "size": 15234,
    "type": "source"
  }
  ```

### Component
- **Properties**: `id`, `name`, `path`, `framework` (lit|stencil), `type` (atomic|functional)
- **Labels**: `Component` (base), plus one: `LitComponent`, `StencilComponent`, `FunctionalComponent`
- **Example**:
  ```json
  {
    "id": 7904,
    "name": "AtomicSearchBox",
    "path": "packages/atomic/src/components/...",
    "framework": "lit",
    "type": "atomic"
  }
  ```

### Controller
- **Properties**: `id`, `name`, `buildFunction`, `className`, `filePath`, `package`, `type`
- **Labels**: `Controller` (base), plus optionally: `HeadlessController`
- **Example**:
  ```json
  {
    "id": 8110,
    "name": "SearchBox",
    "buildFunction": "buildSearchBox",
    "className": "SearchBox",
    "filePath": "packages/headless/dist/...",
    "package": "search",
    "type": "headless"
  }
  ```

### Action
- **Properties**: `id`, `name`, `actionKind` (sync|async), `feature`, `filePath`, `package`, `type`
- **Labels**: `Action` (base), plus optionally: `AsyncAction`
- **Example**:
  ```json
  {
    "id": 8395,
    "name": "executeSearch",
    "actionKind": "async",
    "feature": "search",
    "filePath": "packages/headless/src/...",
    "package": "search",
    "type": "search/executeSearch"
  }
  ```

### Reducer
- **Properties**: `id`, `name`, `feature`, `filePath`, `package`
- **Labels**: `Reducer`
- **Example**:
  ```json
  {
    "id": 8674,
    "name": "searchReducer",
    "feature": "search",
    "filePath": "packages/headless/src/...",
    "package": "search"
  }
  ```

### Engine
- **Properties**: `id`, `name`, `buildFunction`, `filePath`, `package`
- **Labels**: `Engine`
- **Example**:
  ```json
  {
    "id": 8741,
    "name": "SearchEngine",
    "buildFunction": "buildSearchEngine",
    "filePath": "packages/headless/src/...",
    "package": "search"
  }
  ```

### Test
- **Properties**: `id`, `path`, `name`, `framework` (vitest|playwright|cypress)
- **Labels**: `Test` (base), plus one: `UnitTest`, `E2ETest`
- **Example**:
  ```json
  {
    "id": 6826,
    "path": "packages/atomic/src/.../component.spec.ts",
    "name": "component.spec.ts",
    "framework": "vitest"
  }
  ```

### Story
- **Properties**: `id`, `path`, `name`, `component`
- **Labels**: `Story`
- **Example**:
  ```json
  {
    "id": 8744,
    "path": "packages/atomic/src/.../component.stories.tsx",
    "name": "Default",
    "component": "atomic-search-box"
  }
  ```

### Instruction
- **Properties**: `id`, `name`, `path`, `applyTo`, `description`
- **Labels**: `Instruction`
- **Example**:
  ```json
  {
    "id": 9036,
    "name": "atomic",
    "path": ".github/instructions/atomic.instructions.md",
    "applyTo": "packages/atomic/**",
    "description": ""
  }
  ```

### Skill
- **Properties**: `id`, `name`, `path`, `description`
- **Labels**: `Skill`

### Agent
- **Properties**: `id`, `name`, `path`, `description`
- **Labels**: `Agent`

### Prompt
- **Properties**: `id`, `name`, `path`, `description`
- **Labels**: `Prompt`

## Relationship Types

### Actual Relationships in Graph

| Relationship | Source → Target | Description |
|-------------|----------------|-------------|
| `CONTAINS` | `Package` → `File` | Package contains files |
| `CONTAINS` | `File` → `Story` | Story file contains story definitions |
| `DEPENDS_ON` | `Package` → `Package` | Package dependency |
| `DISPATCHES` | `Controller` → `Action` | Controller dispatches actions |
| `EXPORTS` | `File` → `Component` | File exports component |
| `EXPORTS` | `File` → `Action` | File exports action |
| `EXPORTS` | `File` → `Reducer` | File exports reducer |
| `HANDLES` | `Reducer` → `Action` | Reducer handles action |
| `LOADS_BY_DEFAULT` | `Engine` → `Reducer` | Engine loads reducer by default |
| `RENDERS` | `Story` → `Component` | Story renders component |
| `TESTS` | `Test` → `File` | Test tests file/component |
| `USES_CONTROLLER` | `Component` → `Controller` | Component uses controller |
| `USES_ENGINE` | `Story` → `Engine` | Story uses engine |

## Example Graph Structure

```
Package(atomic) --CONTAINS--> File(atomic-search-box.ts)
                --DEPENDS_ON--> Package(headless)

File(atomic-search-box.ts) --EXPORTS--> Component(AtomicSearchBox)

Component(AtomicSearchBox) --USES_CONTROLLER--> Controller(SearchBoxController)

Controller(SearchBoxController) --DISPATCHES--> Action(executeSearch)

Reducer(searchReducer) --HANDLES--> Action(executeSearch)

Engine(SearchEngine) --LOADS_BY_DEFAULT--> Reducer(searchReducer)

Test(atomic-search-box.spec.ts) --TESTS--> File(atomic-search-box.ts)

File(search-box.stories.tsx) --CONTAINS--> Story(Default)

Story(Default) --RENDERS--> Component(AtomicSearchBox)
Story(Default) --USES_ENGINE--> Engine(SearchEngine)
```

## Graph Statistics (as of January 2026)

| Node Type | Count |
|-----------|-------|
| File | 5,411 |
| Test | 1,078 |
| Component | 335 |
| Story | 292 |
| Controller | 285 |
| Action | 279 |
| Reducer | 67 |
| Package | 18 |
| Agent | 11 |
| Prompt | 8 |
| Skill | 6 |
| Instruction | 6 |
| Engine | 3 |

| Relationship Type | Count |
|------------------|-------|
| CONTAINS | 5,503 |
| EXPORTS | 969 |
| TESTS | 836 |
| RENDERS | 761 |
| HANDLES | 401 |
| DISPATCHES | 272 |
| USES_ENGINE | 234 |
| USES_CONTROLLER | 192 |
| LOADS_BY_DEFAULT | 8 |
| DEPENDS_ON | 7 |

## Benefits for AI Agent Querying

With this knowledge graph, AI agents can query:

1. **Component Dependencies**:
   ```cypher
   MATCH (c:Component {name: 'AtomicSearchBox'})-[:USES_CONTROLLER]->(ctrl:Controller)
   RETURN c, ctrl
   ```

2. **Test Coverage**:
   ```cypher
   MATCH (f:File)-[:EXPORTS]->(c:Component)
   OPTIONAL MATCH (t:Test)-[:TESTS]->(f)
   RETURN c.name, count(t) as test_count
   ```

3. **Component Stories**:
   ```cypher
   MATCH (s:Story)-[:RENDERS]->(c:Component)
   RETURN c.name, collect(s.path) as stories
   ```

4. **Action Flow**:
   ```cypher
   MATCH (ctrl:Controller)-[:DISPATCHES]->(a:Action)<-[:HANDLES]-(r:Reducer)
   RETURN ctrl.name, a.name, r.name
   ```

5. **Package Dependencies**:
   ```cypher
   MATCH path = (p1:Package)-[:DEPENDS_ON*]->(p2:Package)
   RETURN path
   ```

6. **Component-Test Mapping**:
   ```cypher
   MATCH (t:Test)-[:TESTS]->(f:File)-[:EXPORTS]->(c:Component)
   RETURN c.name, collect(t.path) as tests
   ```

7. **Engine Configuration**:
   ```cypher
   MATCH (e:Engine)-[:LOADS_BY_DEFAULT]->(r:Reducer)
   RETURN e.name, collect(r.name) as reducers
   ```
