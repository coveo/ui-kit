<template>
  <template lwc:if={shouldDisplayGeneratedAnswer}>
    <div data-cy="generated-answer__card" class="slds-box">
      <div class="generated-answer__card-header slds-grid">
        <span
          class="generated-answer__badge slds-var-p-around_x-small slds-text-title_bold"
          >{labels.generatedAnswerForYou}</span
        >
        <div class="generated-answer__header-actions slds-grid">
          <template lwc:if={shouldDisplayActions}>
            <c-quantic-feedback
              state={feedbackState}
              onlike={handleLike}
              ondislike={handleDislike}
              like-icon-name="utility:like"
              like-label={labels.thisAnswerWasHelpful}
              dislike-icon-name="utility:dislike"
              dislike-label={labels.thisAnswerWasNotHelpful}
              size="xx-small"
              question=""
              hide-explain-why-button
              hide-labels
              data-cy="generated-answer__feedback"
            ></c-quantic-feedback>
            <c-quantic-generated-answer-copy-to-clipboard
              data-cy="generated-answer__copy-to-clipboard"
              answer={answer}
              class="slds-var-m-horizontal_xx-small"
            ></c-quantic-generated-answer-copy-to-clipboard>
          </template>
          <c-quantic-generated-answer-toggle
            is-generated-answer-visible={isVisible}
          ></c-quantic-generated-answer-toggle>
        </div>
      </div>
      <template lwc:if={isVisible}>
        <div
          data-cy="generated-answer__content"
          class="generated-answer__content slds-var-m-top_medium"
        >
          <div data-cy="generated-answer__answer" class={generatedAnswerClass}>
            {answer}
          </div>
          <div data-cy="generated-answer__footer" class={generatedAnswerFooterCssClass}>
            <template lwc:if={hasCitations}>
              <div class="slds-var-m-top_small">
                <c-quantic-source-citations
                  engine-id={engineId}
                  data-cy="generated-answer__citations"
                  citations={citations}
                  citation-hover-handler={handleCitationHover}
                ></c-quantic-source-citations>
              </div>
            </template>
            <template lwc:if={shouldDisplayActions}>
              <div class="slds-var-m-top_small">
                <c-quantic-generated-answer-rephrase-buttons
                  data-cy="generated-answer__rephrase-buttons"
                  value={responseFormat}
                  hide-labels={shouldHideRephraseLabels}
                ></c-quantic-generated-answer-rephrase-buttons>
              </div>
            </template>
          </div>
        </div>
      </template>
    </div>
  </template>
</template>
