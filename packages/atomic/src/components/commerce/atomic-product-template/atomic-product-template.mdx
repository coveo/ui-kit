import { Meta } from '@storybook/addon-docs/blocks';
import * as AtomicProductTemplateStories from './atomic-product-template.new.stories';
import { AtomicDocTemplate } from '../../../../storybook-utils/documentation/atomic-doc-template';


<Meta of={AtomicProductTemplateStories} />

<AtomicDocTemplate
  stories={AtomicProductTemplateStories}
  defaultStory="InAProductList"
  githubPath="commerce/atomic-product-template/atomic-product-template.ts"
  tagName="atomic-product-template"
  className="AtomicProductTemplate"
>

This component defines the UI display of your products. 
A `template` element must be the child of an `atomic-product-template`. Furthermore, an `atomic-commerce-product-list`, `atomic-commerce-recommendation-list`, or `atomic-commerce-search-box-instant-products` must be the parent of each `atomic-product-template`.
* **Note:** Any `<script>` tags that are defined inside a `<template>` element will not be executed when the products are being rendered.

Example using the `atomic-commerce-product-list`:
```html
<atomic-commerce-product-list>
  <atomic-product-template>
    <template>
      <atomic-product-section-name>
        <atomic-product-link class="font-bold"></atomic-product-link>
      </atomic-product-section-name>

      <atomic-product-section-metadata>
        <atomic-product-field-condition if-defined="ec_brand">
          <atomic-product-text
            field="ec_brand"
            class="block text-neutral-dark"
          ></atomic-product-text>
        </atomic-product-field-condition>

        <atomic-product-field-condition if-defined="ec_rating">
          <atomic-product-rating field="ec_rating"></atomic-product-rating>
        </atomic-product-field-condition>
      </atomic-product-section-metadata>

      <atomic-product-section-description>
        <atomic-product-text
          field="excerpt"
          class="block text-neutral-dark"
        ></atomic-product-text>
      </atomic-product-section-description>

      <atomic-product-section-emphasized>
        <atomic-product-price currency="USD"></atomic-product-price>
      </atomic-product-section-emphasized>
    </template>
  </atomic-product-template>
</atomic-commerce-product-list>
```

## Template Conditions

You can use conditions to display different templates based on product properties. You can specify as many `must-match-*` and `must-not-match-*` attributes as you want on a template, each targeting a different field. Each attribute can accept multiple comma-separated values.

**Comma represents OR:** Within a single attribute, comma-separated values represent a logical OR. For example, `must-match-ec_brand="Nike,Adidas"` means the brand must be Nike OR Adidas.

**Multiple attributes represent AND:** All conditions from different attributes must be met (logical AND) for the template to apply to a product.

If you set both `must-match-*` and `must-not-match-*` for the same field and there is any overlap in values, the template will be ignored (it will never match any product).

**Order of declaration matters:** The first template whose conditions are met will be applied. If a default template (without conditions) is declared first, it will apply to all products, even if other templates with conditions are declared later.

**Examples:**

```html
<!-- Template applies if brand is Nike or Adidas, and product is in stock -->
<atomic-product-template
  must-match-ec_brand="Nike,Adidas"
  must-match-ec_in_stock="true"
>
  <template>
    <!-- ... -->
  </template>
</atomic-product-template>

<!-- This template will never apply, because the same value is required and forbidden -->
<atomic-product-template
  must-match-ec_brand="Nike"
  must-not-match-ec_brand="Nike"
>
  <template>
    <!-- ... -->
  </template>
</atomic-product-template>
```

```html
<atomic-commerce-product-list>
  <!-- Template for luxury brands -->
  <atomic-product-template must-match-ec_brand="Gucci,Prada,Louis Vuitton">
    <template>
      <atomic-product-section-name>
        <atomic-product-link class="font-bold text-gold"></atomic-product-link>
      </atomic-product-section-name>
      
      <atomic-product-section-metadata>
        <atomic-product-text field="ec_brand" class="block text-luxury-gold"></atomic-product-text>
        <span class="luxury-badge">âœ¨ Luxury</span>
      </atomic-product-section-metadata>

      <atomic-product-section-emphasized>
        <atomic-product-price currency="USD" class="text-gold"></atomic-product-price>
      </atomic-product-section-emphasized>
    </template>
  </atomic-product-template>

  <!-- Template for out-of-stock products -->
  <atomic-product-template must-match-ec_in_stock="false">
    <template>
      <atomic-product-section-name>
        <atomic-product-link class="font-bold opacity-60"></atomic-product-link>
      </atomic-product-section-name>
      
      <atomic-product-section-metadata>
        <atomic-product-field-condition if-defined="ec_brand">
          <atomic-product-text field="ec_brand" class="block text-neutral-dark"></atomic-product-text>
        </atomic-product-field-condition>
        <span class="out-of-stock-badge text-red-600">Out of Stock</span>
      </atomic-product-section-metadata>

      <atomic-product-section-emphasized>
        <atomic-product-price currency="USD" class="opacity-60"></atomic-product-price>
      </atomic-product-section-emphasized>
    </template>
  </atomic-product-template>

  <!-- Default template for all other products -->
  <atomic-product-template>
    <template>
      <atomic-product-section-name>
        <atomic-product-link class="font-bold"></atomic-product-link>
      </atomic-product-section-name>

      <atomic-product-section-metadata>
        <atomic-product-field-condition if-defined="ec_brand">
          <atomic-product-text field="ec_brand" class="block text-neutral-dark"></atomic-product-text>
        </atomic-product-field-condition>

        <atomic-product-field-condition if-defined="ec_rating">
          <atomic-product-rating field="ec_rating"></atomic-product-rating>
        </atomic-product-field-condition>
      </atomic-product-section-metadata>

      <atomic-product-section-description>
        <atomic-product-text field="excerpt" class="block text-neutral-dark"></atomic-product-text>
      </atomic-product-section-description>

      <atomic-product-section-emphasized>
        <atomic-product-price currency="USD"></atomic-product-price>
      </atomic-product-section-emphasized>
    </template>
  </atomic-product-template>
</atomic-commerce-product-list>
```

</AtomicDocTemplate>

